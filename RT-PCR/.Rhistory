ggdraw()+
draw_plot(mrnaplot, 0, 0, .5, 1)+
draw_plot(vrnaplot, .5, .5, .5, .5)
ggdraw()+
draw_plot(mrnaplot, 0, 0, 0, .5)+
draw_plot(vrnaplot, .5, .5, .5, .5)
ggdraw()+
draw_plot(mrnaplot, 0, 0, 0.5, 1)+
draw_plot(vrnaplot, .5, .5, .5, .5)
ggdraw()+
draw_plot(mrnaplot, 0, 0, 1, .5)+
draw_plot(vrnaplot, .5, .5, .5, .5)
ggdraw()+
draw_plot(mrnaplot, 0.5, 0.5, 1, .5)+
draw_plot(vrnaplot, 0, 0, 1, .5)
ggdraw()+
draw_plot(mrnaplot, 0, 0.5, 1, .5)+
draw_plot(vrnaplot, 0, 0, 1, .5)
data<-ggdraw()+
draw_plot(mrnaplot, 0, 0.5, 1, .5)+
draw_plot(vrnaplot, 0, 0, 1, .5)
```{r global_options, include=FALSE}
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(scales)
library(grid)
library(ggrepel)
library(BSDA)
RTdata <- read.table(file='./RT-PCR.csv', head=TRUE, sep=',', na.strings = '')
RTavg <- RTdata %>%
group_by(gene, experiment, treatment, virus) %>%
summarize(average = mean(ct), stdev = sd(ct), sterror=sd(ct)/sqrt(3))
control <- RTavg %>% filter(gene == 'actin')
names(control) <- c('actincontrol', 'experiment', 'treatment', 'virus', 'avgcontrol', 'stdevcontrol', 'sterrorcontrol')
influenza <- RTavg %>%
filter(gene != 'actin') %>%
left_join(control, by = c('experiment', 'treatment', 'virus')) %>%
mutate(dCT = average - avgcontrol,
sterrordCT = sqrt(sterror + sterrorcontrol),
stdevdCT = sqrt(stdev + stdevcontrol))
INFddCT <- influenza[c(1:4, 12:14)] %>% filter(treatment == 'ifn')
names(INFddCT) <- c('gene', 'experiment', 'treatment', 'virus', 'infdct', 'infsterror', 'infstdev')
noINFddCT <- influenza[c(1:4, 12:14)] %>% filter(treatment != 'ifn')
names(noINFddCT) <- c('gene', 'experiment', 'treatment', 'virus', 'noinfdct', 'noinfsterror', 'noinfstdev')
ddct <- INFddCT[c(1, 2, 4:7)] %>%
left_join(noINFddCT[c(1, 2, 4:7)], by = c('gene', 'experiment', 'virus')) %>%
mutate(ddct = noinfdct - infdct,
ddctsterror = noinfsterror,
ddctstdev = noinfstdev) %>%
mutate(foldchange = 2^(-ddct),
min = 2^(-ddct-ddctsterror),
max = 2^(-ddct+ddctsterror))
ddct$virus <- factor(ddct$virus, levels = c('wt', 'c1', 'c2'))
RTdata <- read.table(file='./RT-PCR.csv', head=TRUE, sep=',', na.strings = '')
RTavg <- RTdata %>%
group_by(gene, experiment, treatment, virus) %>%
summarize(average = mean(ct), stdev = sd(ct), sterror=sd(ct)/sqrt(3))
control <- RTavg %>% filter(gene == 'actin')
names(control) <- c('actincontrol', 'experiment', 'treatment', 'virus', 'avgcontrol', 'stdevcontrol', 'sterrorcontrol')
influenza <- RTavg %>%
filter(gene != 'actin') %>%
left_join(control, by = c('experiment', 'treatment', 'virus')) %>%
mutate(dCT = average - avgcontrol,
sterrordCT = sqrt(sterror + sterrorcontrol),
stdevdCT = sqrt(stdev + stdevcontrol))
INFddCT <- influenza[c(1:4, 12:14)] %>% filter(treatment == 'ifn')
names(INFddCT) <- c('gene', 'experiment', 'treatment', 'virus', 'infdct', 'infsterror', 'infstdev')
noINFddCT <- influenza[c(1:4, 12:14)] %>% filter(treatment != 'ifn')
names(noINFddCT) <- c('gene', 'experiment', 'treatment', 'virus', 'noinfdct', 'noinfsterror', 'noinfstdev')
ddct <- INFddCT[c(1, 2, 4:7)] %>%
left_join(noINFddCT[c(1, 2, 4:7)], by = c('gene', 'experiment', 'virus')) %>%
mutate(ddct = noinfdct - infdct,
ddctsterror = noinfsterror,
ddctstdev = noinfstdev) %>%
mutate(foldchange = 2^(-ddct),
min = 2^(-ddct-ddctsterror),
max = 2^(-ddct+ddctsterror))
ddct$virus <- factor(ddct$virus, levels = c('wt', 'c1', 'c2'))
library("scales")
reverselog_trans <- function(base = exp(1)) {
trans <- function(x) -log(x, base)
inv <- function(x) base^(-x)
trans_new(paste0("reverselog-", format(base)), trans, inv,
log_breaks(base = base),
domain = c(1e-100, Inf))
}
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', ''))
mrnaplot <- ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
coord_cartesian(ylim=c(1,15)) +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=1) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=1) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
mrnaplot <- ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
mrnaplot <- ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=1) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=.5) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='vRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=.5) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='vRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20,30,40,50,60), labels = c('1','','','','','','','','','10','','','','','')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=.5) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
mrnaplot <- ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=.5) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
vrnaplot <- ddct %>%
filter(gene != 'NA', experiment=='vRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20,30,40,50,60), labels = c('1','','','','','','','','','10','','','','','')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=.5) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
data<-ggdraw()+
draw_plot(mrnaplot, 0, 0.5, 1, .5)+
draw_plot(vrnaplot, 0, 0, 1, .5)
ggdraw()+
draw_plot(mrnaplot, 0, 0.5, 1, .5)+
draw_plot(vrnaplot, 0, 0, 1, .5)
```{r global_options, include=FALSE}
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(scales)
library(grid)
library(ggrepel)
library(BSDA)
RTdata <- read.table(file='./RT-PCR.csv', head=TRUE, sep=',', na.strings = '')
RTavg <- RTdata %>%
group_by(gene, experiment, treatment, virus) %>%
summarize(average = mean(ct), stdev = sd(ct), sterror=sd(ct)/sqrt(3))
control <- RTavg %>% filter(gene == 'actin')
names(control) <- c('actincontrol', 'experiment', 'treatment', 'virus', 'avgcontrol', 'stdevcontrol', 'sterrorcontrol')
influenza <- RTavg %>%
filter(gene != 'actin') %>%
left_join(control, by = c('experiment', 'treatment', 'virus')) %>%
mutate(dCT = average - avgcontrol,
sterrordCT = sqrt(sterror + sterrorcontrol),
stdevdCT = sqrt(stdev + stdevcontrol))
INFddCT <- influenza[c(1:4, 12:14)] %>% filter(treatment == 'ifn')
names(INFddCT) <- c('gene', 'experiment', 'treatment', 'virus', 'infdct', 'infsterror', 'infstdev')
noINFddCT <- influenza[c(1:4, 12:14)] %>% filter(treatment != 'ifn')
names(noINFddCT) <- c('gene', 'experiment', 'treatment', 'virus', 'noinfdct', 'noinfsterror', 'noinfstdev')
ddct <- INFddCT[c(1, 2, 4:7)] %>%
left_join(noINFddCT[c(1, 2, 4:7)], by = c('gene', 'experiment', 'virus')) %>%
mutate(ddct = noinfdct - infdct,
ddctsterror = noinfsterror,
ddctstdev = noinfstdev) %>%
mutate(foldchange = 2^(-ddct),
min = 2^(-ddct-ddctsterror),
max = 2^(-ddct+ddctsterror))
ddct$virus <- factor(ddct$virus, levels = c('wt', 'c1', 'c2'))
library("scales")
reverselog_trans <- function(base = exp(1)) {
trans <- function(x) -log(x, base)
inv <- function(x) base^(-x)
trans_new(paste0("reverselog-", format(base)), trans, inv,
log_breaks(base = base),
domain = c(1e-100, Inf))
}
mrnaplot <- ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=.5) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='mRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', '')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=.5) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
ddct %>%
filter(gene != 'NA', experiment=='vRNA') %>%
ggplot(aes(x=virus, y=foldchange, fill=virus)) +
geom_bar(stat="identity", position=position_dodge(), size=.3) +
#scale_x_discrete(limits = c('wt', 'c1', 'c2'
#                            )) +
geom_errorbar(aes(ymin=min, ymax=max, width=.5), color='black', size=.3, position=position_dodge()) +
ylab('Fold Inhibition in RNA on IFN Treatment') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20,30,40,50,60), labels = c('1','','','','','','','','','10','','','','','')) +
scale_x_discrete(position='top') +
facet_wrap(~gene, strip.position='bottom') +
geom_hline(yintercept=1, size=.5) +
theme(legend.position='none',
axis.title.y = element_blank(),
strip.text.x = element_blank(),
strip.text.y = element_blank(),
strip.background = element_rect(linetype = 'solid', colour="black", fill="white"),
axis.title.x = element_blank(),
axis.text.x = element_text(size=12, face='bold'),
axis.ticks.x = element_blank(),
axis.line.x = element_blank()
#panel.border = element_rect(color='black', size=.3, linetype='solid')
)
