H2N2PB1 <- read.csv(file='H2N2PB1.fa.tidy', head=TRUE, sep='\t')
H1N1PB1 <- read.csv(file='H1N1PB1.fa.tidy', head=TRUE, sep='\t')
H3N2PB1 <- read.csv(file='H3N2PB1.fa.tidy', head=TRUE, sep='\t')
PB1a <- inner_join(H2N2PB1, H1N1PB1, by = NULL)
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
```
PB1a <- inner_join(H2N2PB1, H1N1PB1, by = NULL)
PB1a <- inner_join(H2N2PB1, H1N1PB1)
PB1a <- inner_join(H2N2PB1, H1N1PB1, by$strain)
PB1a <- inner_join(H2N2PB1, H1N1PB1, by$sero)
View(H2N2PB1)
PB1a <- merge_all(list(H2N2PB1, H1N1PB1, H3N2PB1), all.x=TRUE, all.y=TRUE)
View(PB1a)
PB1a <- merge_all(list(read.csv(file='H2N2PB1.fa.tidy', head=TRUE, sep='\t'), read.csv(file='H1N1PB1.fa.tidy', head=TRUE, sep='\t'), read.csv(file='H3N2PB1.fa.tidy', head=TRUE, sep='\t')), all.x=TRUE, all.y=TRUE)
PB1 <- merge_all(list(read.csv(file='H2N2PB1.fa.tidy', head=TRUE, sep='\t'), read.csv(file='H1N1PB1.fa.tidy', head=TRUE, sep='\t'), read.csv(file='H3N2PB1.fa.tidy', head=TRUE, sep='\t')), all.x=TRUE, all.y=TRUE)
names(PB1)
PB1 <- merge_all(list(read.csv(file='H2N2PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H1N1PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H3N2PB1.fa.tidy', head=TRUE, sep='\t')),
all.x=TRUE, all.y=TRUE)
codonvalues <- read.csv(file='codonvalues', head=TRUE, sep='\t')
View(codonvalues)
wantedvalues <- codonvalues %>% select(codon, withIFN/noIFN)
wantedvalues <- codonvalues %>% select(codon, withIFN, noIFN)
PB1rtAI <- PB1 %>% left_join(wantedvalues)
names(PB1rtAI)
PB1 <- merge_all(list(read.csv(file='H2N2PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H1N1PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H3N2PB1.fa.tidy', head=TRUE, sep='\t')),
all.x=TRUE, all.y=TRUE)
ggplot(PB1, aes(x=coryear, y=(numcodon), color=sero))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~codon)
PB1 %>% group_by(sero, codon) %>% do(lm.result = lm((numcodon) ~ coryear, data=.)) -> fitted.models
intslope <- do(fitted.models, data.frame(sero=.$sero,cod=.$cod,
intercept=coef(.$lm.result)[1],
slope=coef(.$lm.result)[2]))
rm(fitted.models)
intslope
PB1 %>% group_by(sero, codon) %>%
do(cor.res = cor.test(.$numcodon, .$coryear)) -> cors
corp <- do(cors, data.frame(sero=.$sero, codon=.$codon, cor=.$cor.res$estimate, p=.$cor.res$p.value))
rm(cors)
corp
View(corp)
View(intslope)
codonstats <- select(corp, p) %>% left_join(select(intslope, slope))
codonstats <- select(corp, p)
View(codonstats)
codonstats <- select(corp, codon, p)
View(codonstats)
codonstats <- select(corp, codon, p) %>% left_join(select(intslope, codon, slope))
View(intslope)
codonstats <- select(corp, codon, p) %>% left_join(select(intslope, cod, slope))
PB1 %>% group_by(sero, codon) %>% do(lm.result = lm((numcodon) ~ coryear, data=.)) -> fitted.models
intslope <- do(fitted.models, data.frame(sero=.$sero,codon=.$cod,
intercept=coef(.$lm.result)[1],
slope=coef(.$lm.result)[2]))
rm(fitted.models)
intslope
codonstats <- select(corp, codon, p) %>% left_join(select(intslope, cod, slope))
codonstats <- select(corp, codon, p) %>% left_join(select(intslope, codon, slope))
View(codonstats)
codonvalues <- read.csv(file='codonvalues', head=TRUE, sep='\t')
codonstats <- select(corp, codon, p) %>% left_join(select(intslope, codon, slope)) %>% left_join(select(codonvalues, codon, withIFN, noIFN, CAI)) %>% mutate(rtAI = withIFN/noIFN)
View(codonstats)
codonstats <- select(corp, codon, p) %>% left_join(select(intslope, codon, slope))
View(codonstats)
codonstats <- select(corp, codon, p) %>% left_join(select(intslope, codon, slope))
codonstats <- select(corp, codon, p)
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope))
View(codonstats)
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope)) %>% left_join(select(codonvalues, codon, withIFN, noIFN, CAI)) %>% mutate(rtAI = withIFN/noIFN)
left_join(codonstats, select(codonvalues, codon, withIFN, noIFN, CAI)) %>% mutate(rtAI = withIFN/noIFN)
left_join(codonstats, codonvalues) %>% mutate(rtAI = withIFN/noIFN)
codonstats <- factor(select(corp, sero, codon, p)) %>% factor(left_join(select(intslope, codon, sero, slope))) %>% left_join(codonstats, select(codonvalues, codon, withIFN, noIFN, CAI)) %>% mutate(rtAI = withIFN/noIFN)
corp <- do(cors, data.frame(sero=.$sero, codon=.$codon, cor=factor(.$cor.res$estimate), p=.$cor.res$p.value))
PB1 %>% group_by(sero, codon) %>%
do(cor.res = cor.test(.$numcodon, .$coryear)) -> cors
corp <- do(cors, data.frame(sero=.$sero, codon=.$codon, cor=factor(.$cor.res$estimate), p=.$cor.res$p.value))
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope)) %>% left_join(codonstats, select(codonvalues, codon, withIFN, noIFN, CAI)) %>% mutate(rtAI = withIFN/noIFN)
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope)) %>% left_join(select(codonvalues, codon, withIFN, noIFN, CAI)) %>% mutate(rtAI = withIFN/noIFN)
left_join(codonstats, select(codonvalues, codon, withIFN, noIFN, CAI)) %>% mutate(rtAI = withIFN/noIFN)
someothers <- select(codonvalues, withIFN, noIFN, CAI)
someothers <- select(codonvalues, codon, withIFN, noIFN, CAI)
whatwhat <- left_join(codonstats, someothers)
View(whatwhat)
codonstats <- select(factor(.$corp), factor(sero), codon, p) %>% left_join(select(intslope, codon, sero, slope))
codonstats <- select(factor(corp), factor(sero), codon, p) %>% left_join(select(intslope, codon, sero, slope))
corp <- do(cors, data.frame(sero=.$factor(sero), codon=.$codon, cor=.$cor.res$estimate, p=.$cor.res$p.value))
corp <- do(cors, data.frame(sero=.$(factor(sero)), codon=.$codon, cor=.$cor.res$estimate, p=.$cor.res$p.value))
corp <- do(cors, data.frame(sero=factor(.$sero), codon=.$codon, cor=.$cor.res$estimate, p=.$cor.res$p.value))
corp <- do(cors, data.frame(sero=factor(.$sero), codon=factor(.$codon), cor=factor(.$cor.res$estimate), factor(p=.$cor.res$p.value))
intslope <- do(fitted.models, data.frame(sero=factor(.$sero),
codon=factor(.$cod),
intercept=factor(coef(.$lm.result)[1]),
corp <- do(cors, data.frame(sero=factor(.$sero),
codon=factor(.$codon),
cor=factor(.$cor.res$estimate),
factor(p=.$cor.res$p.value))
corp <- do(cors, data.frame(sero=factor(.$sero),
codon=factor(.$codon),
cor=factor(.$cor.res$estimate),
factor(p=.$cor.res$p.value))
corp <- do(cors, data.frame(sero=factor(.$sero),
codon=factor(.$codon),
cor=factor(.$cor.res$estimate),
factor(p=.$cor.res$p.value)))
corp <- do(cors, data.frame(sero=factor(.$sero),
codon=factor(.$codon),
cor=factor(.$cor.res$estimate),
p=factor(.$cor.res$p.value)))
do(cor.res = factor(cor.test(.$numcodon, .$coryear))) -> cors
do(cor.res = cor.test(.$numcodon, .$coryear)) -> cors
do(cor.res = cor.test(.$numcodon, .$coryear)) -> cors
PB1 <- merge_all(list(read.csv(file='H2N2PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H1N1PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H3N2PB1.fa.tidy', head=TRUE, sep='\t')),
all.x=TRUE, all.y=TRUE)
codonvalues <- read.csv(file='codonvalues', head=TRUE, sep='\t')
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
PB1 <- merge_all(list(read.csv(file='H2N2PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H1N1PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H3N2PB1.fa.tidy', head=TRUE, sep='\t')),
all.x=TRUE, all.y=TRUE)
PB1 %>% group_by(sero, codon) %>% do(lm.result = lm((numcodon) ~ coryear, data=.)) -> fitted.models
intslope <- do(fitted.models, data.frame(sero=.$sero,codon=.$cod,
intercept=coef(.$lm.result)[1],
slope=coef(.$lm.result)[2]))
rm(fitted.models)
PB1 %>% group_by(sero, codon) %>%
do(cor.res = cor.test(.$numcodon, .$coryear)) -> cors
corp <- do(cors, data.frame(sero=.$sero, codon=.$codon, cor=.$cor.res$estimate, p=.$cor.res$p.value))
rm(cors)
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope))
dim(codonstats)
class(codonstats)
class(codonstats$corp)
factor(codonstats$ncorp)
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope))
View(codonstats)
View(codonvalues)
codonstats <- select(corp, sero, factor(codon), p) %>% left_join(select(intslope, factor(codon), sero, slope))
View(corp)
View(intslope)
codonstats <- select(corp, sero, factor(codon), p) %>% left_join(select(intslope, codon, sero, slope))
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope))
someothers <- select(codonvalues, codon, withIFN, noIFN, CAI)
View(someothers)
codonvalues <- read.csv(file='codonvalues', head=TRUE, sep='\t')
someothers <- select(codonvalues, codon, withIFN, noIFN, CAI)
whatwhat <- left_join(codonstats, someothers)
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope)) %>% left_join(select(codonvalues, codon, withIFN, noIFN, CAI))
View(codonstats)
codonstats <- select(corp, sero, codon, p) %>% left_join(select(intslope, codon, sero, slope)) %>% left_join(select(codonvalues, codon, withIFN, noIFN, CAI)) %>% mutate(rtAI = withIFN/noIFN)
View(codonstats)
ggplot(codonstats, aes(x=slope, y=rtAI))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=slope, y=rtAI))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=slope, y=CAI))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=CAI, y=rtAI))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=slope, y=rtAI))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=rtAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=rtAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "slope", minor = "none")
ggplot(codonstats, aes(x=rtAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=log(rtAI), y=log(slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)+ background_grid(major = "xy", minor = "none")
ggplot(codonstats, aes(x=log(rtAI), y=log(slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=log(rtAI), y=log(slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=log(rtAI), y=log(slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero))
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=log(rtAI), y=log(slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero))
View(codonstats)
ggplot(codonstats, aes(x=log1p(rtAI), y=log1p(slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero))
ggplot(codonstats, aes(x=(log(rtAI)), y=slope)+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero))
ggplot(codonstats, aes(x=rtAI, y=slope)+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero))
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=CAI, y=rtAI))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=CAI))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon)+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero))
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon)+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero))
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon)+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(aes(label=codon),hjust=0, vjust=0+facet_wrap(~sero))
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon)+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(aes(label=codon),hjust=0, vjust=0)+facet_wrap(~sero))
ggplot(codonstats, aes(x=rtAI, y=slope)+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(aes(label=codon),hjust=0, vjust=0)+facet_wrap(~sero))
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(aes(label=codon),hjust=0, vjust=0)+facet_wrap(~sero))
ggplot(codonstats, aes(x=rtAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(aes(label=codon),hjust=0, vjust=0)+facet_wrap(~sero))
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(aes(label=codon),hjust=0, vjust=0)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(aes(label=codon),hjust=-4, vjust=0)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(aes(label=codon),hjust=0, vjust=0)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text()+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 8)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 2)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon, size = 1000))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point(base_size = 10)+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(codonstats, aes(x=CAI, y=slope))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(codonstats, aes(x=CAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(codonstats, aes(x=rtAI, y=CAI, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
```{r global_options, include=FALSE}
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
```
##Plotting codons used in each strain
Here we go reading up all my tables and merging 'em together.  I haven't incorporated read() or the join function yet, but its faster cause smaller files:
```{r}
PB1 <- merge_all(list(read.csv(file='H2N2PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H1N1PB1.fa.tidy', head=TRUE, sep='\t'),
read.csv(file='H3N2PB1.fa.tidy', head=TRUE, sep='\t')),
all.x=TRUE, all.y=TRUE)
codonvalues <- read.csv(file='codonvalues', head=TRUE, sep='\t')
PB1 %>% group_by(sero, codon) %>% do(lm.result = lm((numcodon) ~ coryear, data=.)) -> fitted.models
intslope <- do(fitted.models, data.frame(sero=.$sero,codon=.$cod,
intercept=coef(.$lm.result)[1],
slope=coef(.$lm.result)[2]))
rm(fitted.models)
intslope
PB1 %>% group_by(sero, codon) %>%
do(cor.res = cor.test(.$numcodon, .$coryear)) -> cors
corp <- do(cors, data.frame(sero=.$sero, codon=.$codon, cor=.$cor.res$estimate, p=.$cor.res$p.value))
rm(cors)
corp
codonstats <- select(corp, sero, codon, p) %>%
left_join(select(intslope, codon, sero, slope)) %>%
left_join(select(codonvalues, codon, withIFN, noIFN, CAI)) %>%
mutate(rtAI = withIFN/noIFN)
ggplot(codonstats, aes(x=rtAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(codonstats, aes(x=CAI, y=slope, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
ggplot(PB1, aes(x=coryear, y=(numcodon), color=sero))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~codon)
ggplot(PB1, aes(x=coryear, y=(numcodon/numaa), color=sero))+geom_point()+ background_grid(major = "xy", minor = "none")+facet_wrap(~codon)
ggplot(codonstats, aes(x=rtAI, y=CAI, label=codon))+geom_point()+ background_grid(major = "xy", minor = "none")+geom_text(size = 5)+facet_wrap(~sero)
