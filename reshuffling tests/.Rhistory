library(reshape)
library(MASS)
library(plyr)
library(dplyr)
library(scales)
library(grid)
```
```{r}
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.codoncounts', head=TRUE, sep='\t')
codonvalues <-
read.csv(file='codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
PB1 %>%
filter(codon!='ATG', codon!='TGG', codon!='TAA', codon!='TAG', codon!='TGA', year<=29, year>=0) -> filterPB1
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
filterPB1 %>% left_join(codonvaluesbysite) %>% group_by(year, strain) %>%
summarize(score=mean(logratio)) -> rtAIscores
cor(rtAIscores$year, rtAIscores$score)
coef(lm(score ~ year, rtAIscores))['year']
ggplot(rtAIscores, aes(x=year, y=score)) + geom_point() + geom_smooth(method='lm', se=FALSE)
cor(rtAIscores$year, rtAIscores$score)
View(codonvalues)
View(codonvaluesbysite)
View(PB1)
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.codoncounts', head=TRUE, sep='\t') %>% mutate(coryear = year-1968)
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
PB1 %>%
filter(codon!='ATG', codon!='TGG', codon!='TAA', codon!='TAG', codon!='TGA', coryear<=29, coryear>=0) -> filterPB1
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
filterPB1 %>% left_join(codonvaluesbysite) %>% group_by(year, strain) %>%
summarize(score=mean(logratio)) -> rtAIscores
cor(rtAIscores$year, rtAIscores$score)
coef(lm(score ~ year, rtAIscores))['year']
ggplot(rtAIscores, aes(x=year, y=score)) + geom_point() + geom_smooth(method='lm', se=FALSE)
cor(rtAIscores$year, rtAIscores$score)
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.individualcodoncounts', head=TRUE, sep='\t')
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.individualcodoncounts', head=TRUE, sep='\t')
PB1 %>%
filter(coryear<=29, coryear>=0) -> filterPB1
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
filterPB1 %>% left_join(codonvaluesbysite) %>% group_by(year, strain) %>%
summarize(score=mean(logratio)) -> rtAIscores
cor(rtAIscores$year, rtAIscores$score)
coef(lm(score ~ year, rtAIscores))['year']
ggplot(rtAIscores, aes(x=year, y=score)) + geom_point() + geom_smooth(method='lm', se=FALSE)
cor(rtAIscores$year, rtAIscores$score)
codonvalues <-
read.csv(file='codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, CAI, CAImax))
PB1 %>%
filter(codon!='ATG', codon!='TGG', codon!='TAA', codon!='TAG', codon!='TGA', year<=29) ->
filterPB1
rm(PB1)
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:10){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=as.numeric(sample(CAI)), randomhigh=max(CAI))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=(prod(randomscore)**(1/length(position)))/(prod(randomhigh)**(1/length(position)))) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
z <- (0.9022006 - pop_mean)/pop_sd
pnorm(-z)
sum(abs(statsR$R)>=0.9022006)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.9022006, linetype=2)
pop_sd <- sd(statsslope$slope)*sqrt((length(statsslope$slope)-1)/(length(statsslope$slope)))
pop_mean <- mean(statsslope$slope)
z <- (0.0003085901 - pop_mean)/pop_sd
pnorm(-z)
sum(abs(statsslope$slope)>=0.0003085901)/nrow(statsslope)
statsslope %>% ggplot(aes(x=slope)) + geom_density() + geom_vline(xintercept = 0.0003085901, linetype=2)
View(codonvalues)
View(codonvaluesbysite)
View(filterPB1)
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.individualcodoncounts', head=TRUE, sep='\t')
View(PB1)
PB1 %>%
filter(year<=29, year>=0) -> filterPB1
View(PB1)
codonvalues <-
read.csv(file='codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, CAI, CAImax))
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, CAI, CAImax))
PB1 %>%
filter(year<=29) ->
filterPB1
library(magrittr)
library(tidyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(plyr)
library(dplyr)
library(scales)
library(grid)
PB1 %>%
filter(year<=29) ->
filterPB1
PB1 %>% group_by(year, strain) %>%
summarize(score=(prod(randomscore)**(1/length(position)))/(prod(randomhigh)**(1/length(position)))) -> rtAIscores
View(PB1)
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.individualcodoncounts', head=TRUE, sep='\t')
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
min(PB1, year)
min(PB1, 'year')
PB1 %>%
filter(is.NA(year)!=TRUE) -> filterPB1
filter(year!=NA) -> filterPB1
PB1 %>%
filter(year!=NA) -> filterPB1
View(PB1)
PB1 %>%
filter(year==NA) -> filterPB1
PB1 %>%
filter(year==45) -> filterPB1
PB1 %>%
filter(year<=45) -> filterPB1
PB1 %>%
filter(year=<45) -> filterPB1
library(dplyr)
library(tidyr)
PB1 %>%
filter(year<=45) -> filterPB1
PB1 %>%
dplyr::filter(year<=45) -> filterPB1
PB1 %>%
tidyr::filter(year<=45) -> filterPB1
PB1 %>% filter(year<=45)
filter(PB1, year<=45)
filter(PB1, year <= 45)
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.individualcodoncounts', head=TRUE, sep='\t')
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
PB1 %>% filter(PB1, year <= 45)
filter(PB1, year <= 45)
PB1 %>% filter(year<=29) -> filterPB1
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
filterPB1 %>% left_join(codonvaluesbysite) %>% group_by(year, strain) %>%
summarize(score=mean(logratio)) -> rtAIscores
cor(rtAIscores$year, rtAIscores$score)
coef(lm(score ~ year, rtAIscores))['year']
ggplot(rtAIscores, aes(x=year, y=score)) + geom_point() + geom_smooth(method='lm', se=FALSE)
cor(rtAIscores$year, rtAIscores$score)
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, CAI, CAImax))
PB1 %>%
filter(year<=29) ->
filterPB1
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:10){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=as.numeric(sample(CAI)), randomhigh=max(CAI))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=(prod(randomscore)**(1/length(position)))/(prod(randomhigh)**(1/length(position)))) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
z <- (0.9022006 - pop_mean)/pop_sd
pnorm(-z)
sum(abs(statsR$R)>=0.9022006)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.9022006, linetype=2)
pop_sd <- sd(statsslope$slope)*sqrt((length(statsslope$slope)-1)/(length(statsslope$slope)))
pop_mean <- mean(statsslope$slope)
z <- (0.0003085901 - pop_mean)/pop_sd
pnorm(-z)
sum(abs(statsslope$slope)>=0.0003085901)/nrow(statsslope)
statsslope %>% ggplot(aes(x=slope)) + geom_density() + geom_vline(xintercept = 0.0003085901, linetype=2)
```
PB1 %>%
filter(year<=29) ->
filterPB1
rm(PB1)
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:10){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=sample(logratio))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=mean(randomscore)) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
sum(abs(statsR$R)>=0.3457383)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.3457383, linetype=2)
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, logratio))
PB1 %>%
filter(year<=29) ->
filterPB1
rm(PB1)
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:10){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=sample(logratio))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=mean(randomscore)) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
sum(abs(statsR$R)>=0.3457383)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.3457383, linetype=2)
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
PB1 %>%
filter(year<=29) ->
filterPB1
rm(PB1)
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:10){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=sample(logratio))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=mean(randomscore)) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
sum(abs(statsR$R)>=0.3457383)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.3457383, linetype=2)
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.individualcodoncounts', head=TRUE, sep='\t')
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
PB1 %>%
filter(year<=29) ->
filterPB1
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:10){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=sample(logratio))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=mean(randomscore)) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
sum(abs(statsR$R)>=0.3457383)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.3457383, linetype=2)
codonvalues <-
read.csv(file='codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, GC))
PB1 %>%
filter(codon!='ATG', codon!='TGG', codon!='TAA', codon!='TAG', codon!='TGA', year<=29) ->
filterPB1
rm(PB1)
filterPB1 %>% left_join(codonvalues) %>% group_by(year, strain) %>%
summarize(score=mean(GC)) -> rtAIscores
cor(rtAIscores$year, rtAIscores$score)
coef(lm(score ~ year, rtAIscores))['year']
ggplot(rtAIscores, aes(x=year, y=score)) + geom_point() + geom_smooth(method='lm', se=FALSE)
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:1000){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=sample(GC))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=mean(randomscore)) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
z <- (0.5403361 - pop_mean)/pop_sd
pnorm(-z)
sum(abs(statsR$R)>=0.5403361)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.5403361, linetype=2)
read.csv(file='codonvalues.csv', head=TRUE, sep=',')
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, GC))
PB1 %>%
filter(codon!='ATG', codon!='TGG', codon!='TAA', codon!='TAG', codon!='TGA', year<=29) ->
filterPB1
rm(PB1)
filterPB1 %>% left_join(codonvalues) %>% group_by(year, strain) %>%
summarize(score=mean(GC)) -> rtAIscores
cor(rtAIscores$year, rtAIscores$score)
coef(lm(score ~ year, rtAIscores))['year']
ggplot(rtAIscores, aes(x=year, y=score)) + geom_point() + geom_smooth(method='lm', se=FALSE)
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:1000){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=sample(GC))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=mean(randomscore)) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, GC))
PB1 %>%
filter(year<=29) ->
filterPB1
rm(PB1)
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:10){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=sample(GC))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=mean(randomscore)) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
z <- (0.5403361 - pop_mean)/pop_sd
pnorm(-z)
sum(abs(statsR$R)>=0.5403361)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.5403361, linetype=2)
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
PB1 %>%
filter(year<=29) ->
filterPB1
codonvaluesbysite=NULL
pos=0
for(i in 1:764){
pos = pos + 1
codonvaluesbysite <- rbind(codonvaluesbysite, mutate(codonvalues, position=pos))
}
rm(pos, i)
statsR = NULL #store correlation coefficients
statsslope = NULL #store slopes
for(i in 1:1000){
rando <- codonvaluesbysite %>% group_by(aa, position) %>% mutate(randomscore=sample(logratio))
filterPB1 %>% left_join(rando) %>% group_by(year, strain) %>%
summarize(score=mean(randomscore)) -> rtAIscores
R <- cor(rtAIscores$year, rtAIscores$score) #calculate correlation coefficient
statsR <- rbind(statsR, data.frame(R)) #store correlation coefficient
slope <- coef(lm(score ~ year, rtAIscores))['year'] #calculate slope
statsslope <- rbind(statsslope, data.frame(slope)) #store slope
}
pop_sd <- sd(statsR$R)*sqrt((length(statsR$R)-1)/(length(statsR$R)))
pop_mean <- mean(statsR$R)
sum(abs(statsR$R)>=0.902)/nrow(statsR)
statsR %>% ggplot(aes(x=R)) + geom_density() + geom_vline(xintercept = 0.902, linetype=2)
library(magrittr)
library(tidyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(plyr)
library(dplyr)
library(scales)
library(grid)
library(magrittr)
library(tidyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(plyr)
library(dplyr)
library(scales)
library(grid)
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.individualcodoncounts', head=TRUE, sep='\t')
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
select(c(codon, aa, CAI, CAImax))
library(magrittr)
library(tidyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(plyr)
library(dplyr)
library(scales)
library(grid)
PB1 <- read.csv(file='../sequences/H3N2PB1.fasta.individualcodoncounts', head=TRUE, sep='\t')
codonvalues <-
read.csv(file='../tRNA-seq results/codonvalues.csv', head=TRUE, sep=',') %>%
mutate(logratio = log(AIFNratiosum/AnoIFNratiosum)) %>%
select(c(codon, aa, logratio))
