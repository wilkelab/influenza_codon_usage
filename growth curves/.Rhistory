scale_y_reverse(lim=c(20, 1), expand = c(0,0)) +
#scale_y_continuous(lim=c(0,20), expand = c(0,0)) +
guides(fill = FALSE)
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(20,0), expand=FALSE) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0)) +
#scale_y_continuous(lim=c(0,20), expand = c(0,0)) +
guides(fill = FALSE)
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20), expand=FALSE) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0)) +
#scale_y_continuous(lim=c(0,20), expand = c(0,0)) +
guides(fill = FALSE)
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0)) +
#scale_y_continuous(lim=c(0,20), expand = c(0,0)) +
guides(fill = FALSE)
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
#coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0)) +
#scale_y_continuous(lim=c(0,20), expand = c(0,0)) +
guides(fill = FALSE)
#A549
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
#coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0)) +
#scale_y_continuous(lim=c(0,20), expand = c(0,0)) +
#
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
#coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0))
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
#coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0))
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0))
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(20,0)) +
scale_y_reverse(lim=c(20, 1), expand = c(0,0))
#scale_y_continuous(lim=c(0,20), expand = c(0,0)) +
#guides(fill = FALSE)
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
#scale_y_reverse(lim=c(20, 1), expand = c(0,0))
scale_y_continuous(lim=c(1,20), expand = c(0,0), trans = "reverse")
```
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
#scale_y_reverse(lim=c(20, 1), expand = c(0,0))
scale_y_continuous(lim=c(1,20), expand = c(1,0), trans = "reverse")
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
#scale_y_reverse(lim=c(20, 1), expand = c(0,0))
scale_y_continuous(lim=c(1,20), expand = c(1,1), trans = "reverse")
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
#scale_y_reverse(lim=c(20, 1), expand = c(0,0))
scale_y_continuous(lim=c(0,20), expand = c(0,0), trans = "reverse")
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
#scale_y_reverse(lim=c(20, 1), expand = c(0,0))
scale_y_continuous(lim=c(0,20), expand = c(0,0), trans = "reverse") +
guides(fill = FALSE)
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
#coord_cartesian(ylim=c(0,20)) +
#scale_y_reverse(lim=c(20, 1), expand = c(0,0))
scale_y_continuous(lim=c(0,20), expand = c(0,0), trans = "reverse")
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
#coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 0), expand = c(0,0))
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
#coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 0), expand = c(0,0)) +
#scale_y_continuous(lim=c(0,20), expand = c(0,0), trans = "reverse") +
guides(fill = FALSE)
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(lim=c(20, 1))
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(20,0)) +
scale_y_reverse(lim=c(20, 1))
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(0,20)) +
scale_y_reverse(expand = c(0,0))
foldchanges %>% filter(cell=='a549') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(1,20)) +
scale_y_reverse(expand = c(0,0))
View(foldchanges)
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2', 'sigall'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(1,20)) +
scale_y_reverse(expand = c(0,0))
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(1,20)) +
scale_y_reverse(expand = c(0,0))
```{r global_options, include=FALSE}
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(scales)
library(BSDA)
sigraw <- read.csv(file='newcurves.csv', head=TRUE)
sigraw$treatment <- factor(sigraw$treatment, levels = c('untreated', 'IFN treated'))
sigraw$strain <- factor(sigraw$strain, levels = c('ud', 'sig1', 'sig2', 'sigall'))
sigraw %>%
ggplot(aes(x=treatment, y=titer.pfu.mL., fill=treatment)) +
geom_point(aes(color=treatment), position=position_dodge(width=0.9), size=5) +
geom_errorbar(aes(ymin=titer.pfu.mL.-sd/sqrt(3), ymax=titer.pfu.mL.+sd/sqrt(3), width=.5), color='black', position=position_dodge(.9)) +
ylab('Titer at 36 hours (pfu/mL)') +
xlab('Treatment condition') +
scale_y_log10(lim=c(10000, 50000000), breaks=c(1000, 10000,100000,1000000,10000000,100000000)) +
facet_grid(~strain, scales='free_x') +
panel_border() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_rect(color = "black", fill = NA, size = 1),
strip.background = element_rect(color = "black"),
legend.position="none")
View(sigraw)
sigraw %>% filter(strain != 'sigall') %>%
ggplot(aes(x=treatment, y=titer.pfu.mL., fill=treatment)) +
geom_point(aes(color=treatment), position=position_dodge(width=0.9), size=5) +
geom_errorbar(aes(ymin=titer.pfu.mL.-sd/sqrt(3), ymax=titer.pfu.mL.+sd/sqrt(3), width=.5), color='black', position=position_dodge(.9)) +
ylab('Titer at 36 hours (pfu/mL)') +
xlab('Treatment condition') +
scale_y_log10(lim=c(10000, 50000000), breaks=c(1000, 10000,100000,1000000,10000000,100000000)) +
facet_grid(~strain, scales='free_x') +
panel_border() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_rect(color = "black", fill = NA, size = 1),
strip.background = element_rect(color = "black"),
legend.position="none")
```{r global_options, include=FALSE}
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(scales)
library(BSDA)
foldchanges <- read.csv(file='foldchanges.csv', head=TRUE)
foldchanges$Virus <- factor(sigraw$strain, levels = c('ud', 'sig1', 'sig2', 'sigall'))
#A549
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
coord_cartesian(ylim=c(1,20)) +
scale_y_reverse(expand = c(0,0))
#scale_y_continuous(lim=c(0,20), expand = c(0,0), trans = "reverse") +
#guides(fill = FALSE)
library(scales)
library("scales")
reverselog_trans <- function(base = exp(1)) {
trans <- function(x) -log(x, base)
inv <- function(x) base^(-x)
trans_new(paste0("reverselog-", format(base)), trans, inv,
log_breaks(base = base),
domain = c(1e-100, Inf))
}
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10))
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand = c(0.0))
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand = c(0.0))
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10))
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0))
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20))
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10'))
foldchanges %>% filter(cell=='a549', Virus != 'sigall') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', ''))
```{r global_options, include=FALSE}
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(scales)
library(BSDA)
library(scales)
foldchanges <- read.csv(file='foldchanges.csv', head=TRUE)
foldchanges$Virus <- factor(sigraw$strain, levels = c('ud', 'con3', 'con4', 'con5'))
library("scales")
reverselog_trans <- function(base = exp(1)) {
trans <- function(x) -log(x, base)
inv <- function(x) base^(-x)
trans_new(paste0("reverselog-", format(base)), trans, inv,
log_breaks(base = base),
domain = c(1e-100, Inf))
}
#A549
foldchanges %>% filter(cell=='a549', Virus != 'con5') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', ''))
#scale_y_continuous(lim=c(0,20), expand = c(0,0), trans = "reverse") +
#guides(fill = FALSE)
#t-test for fold inhibition sig1 construct vs. wt
tsum.test(16.973984, s.x=3.3139883, n.x=3, mean.y=3.388356, s.y=0.6044129, n.y=3, alternative = "greater", mu = 0, var.equal = FALSE, conf.level = 0.95)
#p=.008361
#t-test for fold inhibition sig2 construct vs. wt
tsum.test(16.973984, s.x=3.3139883, n.x=3, mean.y=4.571065, s.y=0.8246825, n.y=3, alternative = "greater", mu = 0, var.equal = FALSE, conf.level = 0.95)
#p=.009078
#t-test for fold inhibition sigall construct vs. wt
tsum.test(16.973984, s.x=3.3139883, n.x=3, mean.y=4.795833, s.y=1.0428577, n.y=3, alternative = "greater", mu = 0, var.equal = FALSE, conf.level = 0.95)
#p=.008341
foldchanges %>% filter(cell=='a549', Virus != 'con5') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', ''))
scale_y_continuous(lim=c(0,20), expand = c(0,0), trans = "reverse") +
guides(fill = FALSE)
foldchanges %>% filter(cell=='a549', Virus != 'con5') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'sig1', 'sig2'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', ''))
sigraw <- read.csv(file='newcurves.csv', head=TRUE)
sigraw$treatment <- factor(sigraw$treatment, levels = c('untreated', 'IFN treated'))
sigraw$strain <- factor(sigraw$strain, levels = c('ud', 'sig1', 'sig2', 'sigall'))
sigraw %>% filter(strain != 'sigall') %>%
ggplot(aes(x=treatment, y=titer.pfu.mL., fill=treatment)) +
geom_point(aes(color=treatment), position=position_dodge(width=0.9), size=5) +
geom_errorbar(aes(ymin=titer.pfu.mL.-sd/sqrt(3), ymax=titer.pfu.mL.+sd/sqrt(3), width=.5), color='black', position=position_dodge(.9)) +
ylab('Titer at 36 hours (pfu/mL)') +
xlab('Treatment condition') +
scale_y_log10(lim=c(10000, 50000000), breaks=c(1000, 10000,100000,1000000,10000000,100000000)) +
facet_grid(~strain, scales='free_x') +
panel_border() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_rect(color = "black", fill = NA, size = 1),
strip.background = element_rect(color = "black"),
legend.position="none")
sigraw <- read.csv(file='newcurves.csv', head=TRUE)
sigraw$treatment <- factor(sigraw$treatment, levels = c('untreated', 'IFN treated'))
sigraw$strain <- factor(sigraw$strain, levels = c('ud', 'con3', 'con4', 'con5'))
sigraw %>% filter(strain != 'con5') %>%
ggplot(aes(x=treatment, y=titer.pfu.mL., fill=treatment)) +
geom_point(aes(color=treatment), position=position_dodge(width=0.9), size=5) +
geom_errorbar(aes(ymin=titer.pfu.mL.-sd/sqrt(3), ymax=titer.pfu.mL.+sd/sqrt(3), width=.5), color='black', position=position_dodge(.9)) +
ylab('Titer at 36 hours (pfu/mL)') +
xlab('Treatment condition') +
scale_y_log10(lim=c(10000, 50000000), breaks=c(1000, 10000,100000,1000000,10000000,100000000)) +
facet_grid(~strain, scales='free_x') +
panel_border() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_rect(color = "black", fill = NA, size = 1),
strip.background = element_rect(color = "black"),
legend.position="none")
```{r global_options, include=FALSE}
library(magrittr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(reshape)
library(MASS)
library(scales)
library(BSDA)
library(scales)
foldchanges <- read.csv(file='foldchanges.csv', head=TRUE)
foldchanges$Virus <- factor(sigraw$strain, levels = c('ud', 'con3', 'con4', 'con5'))
library("scales")
reverselog_trans <- function(base = exp(1)) {
trans <- function(x) -log(x, base)
inv <- function(x) base^(-x)
trans_new(paste0("reverselog-", format(base)), trans, inv,
log_breaks(base = base),
domain = c(1e-100, Inf))
}
#A549
foldchanges %>% filter(cell=='a549', Virus != 'con5') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'con3', 'con4'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', ''))
View(foldchanges)
foldchanges <- read.csv(file='foldchanges.csv', head=TRUE)
foldchanges$Virus <- factor(sigraw$strain, levels = c('ud', 'con3', 'con4', 'con5'))
library("scales")
reverselog_trans <- function(base = exp(1)) {
trans <- function(x) -log(x, base)
inv <- function(x) base^(-x)
trans_new(paste0("reverselog-", format(base)), trans, inv,
log_breaks(base = base),
domain = c(1e-100, Inf))
}
#A549
foldchanges %>% filter(cell=='a549', Virus != 'con5') %>%
ggplot(aes(x=Virus, y=Fold.change, fill=Virus)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_x_discrete(limits = c('ud', 'con3', 'con4'), position = 'top') +
geom_errorbar(aes(ymin=Fold.change-sd/sqrt(3), ymax=Fold.change+sd/sqrt(3), width=.5), color='black', size=.3, position=position_dodge()) +
theme(legend.position="none") +
ylab('Fold Viral Attenuation Between IFN and Untreated') +
scale_y_continuous(trans=reverselog_trans(10), expand=c(0,0), breaks = c(1,2,3,4,5,6,7,8,9,10,20), labels = c('1','','','','','','','','','10', ''))
